[{"content":"常常为了快速查找 R 函数，会把一些功能相近的 R 函数做成速查表（cheat sheets/cheatsheets，也见翻译成小抄、备忘录），便于索引、参考，比如，RStudio 做了很多这种速查表（管理的 Github 仓库）。记得早几年也有过一些流行的中文翻译版，想必难以与原版的更新同步，又正值如今网上资源泛滥，流传得少了。 统计分析也有一些这样的速查表，似乎容易被大众忽略。印象比较深的是统计之都上的一篇文章《翻译：常见统计检验的本质都是线性模型（或：如何教统计学）》，尽管这个表格并不是以速查表作为目的而设计。 使用 R 进行统计分析的速查表似乎较少见到，但“我”更愿意相信：我能想到的东西别人也能想到，只是还没有被自己发现。遂搜了一下，的确是有的，比如Statistics Cheat Sheets（Basic statistics with R Cheat Sheet），看来日后也可收集一二。 回到正题，这里所列的标准假设检验（Standard Hypothesis Testing）的速查表，是直接引用自 The R Software : Fundamentals of Programming and Statistical Analysis （p.447）及其中文翻译版《R软件教程与统计分析——入门到精通》（pp.406-407），供查阅参考。 Table 1 标准检验（中文译版） 本质 数据 有效性条件 R 函数 参数检验： 均值 单样本 \\(n  30\\) 或正态性 t.test(x,...) 两样本 正态性与同方差 t.test(x,y,...) 两样本 正态性 t.test(x,y,var.equal=F) 两配对样本 \\(n  30\\) 或正态性 t.test(x,y,paried=T) 方差 单样本 正态性 sigma2.test(x,...) 两样本 正态性 var.test(x,y,...) 两样本 大样本 asymp.test(x,y,...) 相关系数 单样本 正态性, \\(H_0:\\rho=\\rho_0\\) cor.test(x,y...) 两样本 正态性 cor.test.2.sample(x,y,...) 比例 单样本 \\(np≥5\\) 且 \\(n(1-p)≥5\\) prop.test(x,...) 单样本 binom.test(x,...) 两样本 大样本 prop.test(x,y,...) 独立性检验： \\(\\chi^2\\) 独立性检验 列联表 理论计数 \\(≥5\\) chisq.test(.,correct=F) Yates \\(\\chi^2\\) 检验 2×2 表 理论计数 \\(≥2.5\\) chisq.test() Fisher 精确检验 列联表 fisher.test() 一个分布的拟合效果的检验： Shapiro-Wilk 单样本 shapiro.text(x,...) 一个分布的拟合效果的 \\(\\chi^2\\) 检验 单样本 理论计数 \\(≥5\\) chisq.test() Kolmogorov-Smirnov 单样本 ks.test(x,.) 两样本 ks.test(x,y) 位置的检验： 中位数 单样本 binom.test(x,) 符号检验 两样本 fisher.test(x,y) 两配对样本 binom.test(x,y,paired=T) Mann-Whitney 两样本 \\(min(n_1,n_2)≥10\\) wilcox.test(x,y,exact=F) Mann-Whitney 两样本 \\(min(n_1,n_2)≤10\\) wilcox.test(x,y) Wilcoxon 两配对样本 wilcox.test(x,y,paried=T) 引自：Pierre Lafaye de Micheaux, Rémy Drouilhet, Benoit Liquet. 2013. The R Software: Fundamentals of Programming and Statistical Analysis. Springer, New York, NY. doi: 10.1007/978-1-4614-9020-3. p.447. 潘东东, 李启寨, 唐年胜, 译. 2015. R 软件教程与统计分析——入门到精通. 北京：高等教育出版社. pp.406-407. Table 2 Standard tests（英文原版） Nature Data Conditions for validaty R function Parametric tests Mean 1 sample \\(n 30\\) or normality t.test(x,...) 2 samples Normality and equal variances t.test(x,y,...) 2 samples Normality t.test(x,y,var.equal=F) 2 paired samples \\(n 30\\) or normality t.test(x,y,paried=T) Variance 1 sample Normality sigma2.test(x,...) 2 samples Normality var.test(x,y,...) 2 samples Large sample size asymp.test(x,y,...) Correlation 1 sample Normality, \\(H_0:\\rho=\\rho_0\\) cor.test(x,y) 2 samples Normality cor.test.2.sample(x,y) Proportion 1 sample \\(np≥5\\) and \\(n(n-p)≥5\\) prop.test(x,...) 1 sample binom.test(x,...) 2 samples Large sample size prop.test(x,y,...) Independence tests \\(\\chi^2\\) for independence contingency table Theoretical counts ≥ 5 chisq.test(.,correct=F) Yates' \\(\\chi^2\\) 2×2 table Theoretical counts ≥ 2.5 chisq.test() Fisher's exact test contingency table fisher.test() Tests of fit to a distribution Shapiro-Wilk 1 sample shapiro.test(x,...) \\(\\chi^2\\) of fit to a distribution 1 sample Theoretical counts ≥ 5 chisq.test() Kolmogorov-Smirnov 1 sample ks.test(x,.) 2 samples ks.test(x,y) Tests of position Median 1 sample binom.test(x,.) Sign test 2 samples fisher.test(x,y) 2 paired samples binom.test(x,y,paried=T) Mann-Whitney 2 samples \\(min(n_1,n_2)≥10\\) wilcox.test(x,y,exact=F) Mann-Whitney 2 samples \\(min(n_1,n_2)≤10\\) wilcox.test(x,y) Wilcoxon 2 paired samples wilcox.test(x,y,paired=T) ","title":"R 速查表：标准假设检验","uri":"/note/r-cheatsheet-standard-tests/"},{"content":" 警示：水平有限，以下内容均有可能存在错漏！ 如有发现，请下方留言或提交 pull request，感谢您的贡献！ 仅供参考的示例； 没有通用的模板。 了解统计更重要； 照搬后果请自负。 本分析以多物种、双因素为例，展示常用的方差分析的 R 实现。当然，通过少量的调整，也可以向下兼容：单物种、单因素；也可能向上兼容：三因素至多因素。例如，“三因素”可假想成“双因素中的一个因素再包含一双因素”，一些双因素的函数通过自我函数嵌套，可实现扩展。 一个分析需求，常常对应着多种 R 实现，本示例列举了常用的几种。有些采用 R 中常用的批量（如循环、重复、分组等）计算方式，尽可能地避免使用大量重复代码；有些方法为了篇幅的简洁，仅以局部单一情况做演示，但是它们都可以用类似的方式实现批量计算，参照上下文自行调整即可。 本示例原文档下载地址：https://github.com/pftz/pftz/blob/master/content/post/2021-07-23-r-anova/index.Rmd 示例数据 x，自变量，解释变量，预测变量，独立变量，IV (Independent variables) y，因变量，响应变量，结果变量，依赖变量，DV (Dependent variables) 构建示例用数据 # 构建一个伪造的示例数据框 set.seed(110) df F) ## drought 2 0.6133 0.30664 93.43 4.83e-08 *** ## Residuals 12 0.0394 0.00328 ## --- ## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 # 方法二：回归方法 # 默认第一个水平（fertilizer: Control）为参照 levels(df_aa_npk$drought) ## [1] \"D25\" \"D50\" \"D75\" lm_b1dry F) ## drought 2 0.61328 0.306639 93.427 4.829e-08 *** ## Residuals 12 0.03939 0.003282 ## --- ## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 # 方法三：car::Anova library(car) Anova(lm_b1dry) ## Anova Table (Type II tests) ## ## Response: biomass ## Sum Sq Df F value Pr(F) ## drought 0.61328 2 93.427 4.829e-08 *** ## Residuals 0.03939 12 ## --- ## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 手算方差分析平方和（番外） 组间平方和 Sum of Squares due to Treatment (SSTR) the treatment sum of squares the sum of squares for treatments \\[ \\begin{align} SSTR \u0026 = \\sum_{i=1}^k\\sum_{j=1}^n(\\bar x_i-\\bar x')^2 \\\\ \u0026 = \\Sigma_{i=1}^kn_i(\\bar x_i-\\bar x')^2 \\\\ \u0026 = \\sum_{i}n_i(\\overline{Y}_i-\\overline{Y}_{total})^2 \\end{align} \\] 组内平方和 the Sum of Squares due to Error (SSE) the error sum of squares the sum of squares of the residual error \\[ \\begin{align} SSE \u0026 = \\sum_{i=1}^k\\sum_{j=1}^n(x_ij-\\bar x_i)^2 \\\\ \u0026 = \\sum_{i}\\sum_{j}(Y_{ij}-\\overline{Y}_i)^2 \\end{align} \\] #- 组间平方和 within groups，处理误差 # 5 个重复 sum((tapply(df_aa_npk$biomass, df_aa_npk$drought, mean) - mean(df_aa_npk$biomass))^2)*5 ## [1] 0.6132778 #- 组内平方和 between groups，随机误差 # 4 个物种 sum((tapply(df_aa_npk$biomass,df_aa_npk$drought,var)))*4 ## [1] 0.0393857 多因素 本示例为重复试验、非重复测量。 分析不同物种、不同种植密度、不同施肥处理对产量的影响，即把物种也视为一种处理（不推荐）： # 不含交互项 aov_b2main F) ## drought 2 0.83730 0.41865 187.567 2.234e-15 *** ## fertilizer 1 0.02441 0.02441 10.935 0.002963 ** ## drought:fertilizer 2 0.07114 0.03557 15.936 3.947e-05 *** ## Residuals 24 0.05357 0.00223 ## --- ## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 ## ## $BB ## Analysis of Variance Table ## ## Response: biomass ## Df Sum Sq Mean Sq F value Pr(F) ## drought 2 0.66154 0.33077 136.2385 7.919e-14 *** ## fertilizer 1 0.01243 0.01243 5.1195 0.03299 * ## drought:fertilizer 2 0.02671 0.01336 5.5011 0.01080 * ## Residuals 24 0.05827 0.00243 ## --- ## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 ## ## $CC ## Analysis of Variance Table ## ## Response: biomass ## Df Sum Sq Mean Sq F value Pr(F) ## drought 2 0.72532 0.36266 607.291 F) ## drought 2 0.81257 0.40629 478.368 |t|) ## D50 - D25 == 0 0.37255 0.03623 10.28 2000 时 检验方差齐性 Bartlett test Fligner-Killeen test Brown-Forsythe test Levene’s test # 残差分析 par(mfrow = c(2, 2)) plot(lrm_b2mix_sp$AA) Figure 20: 回归检验组图 # 使用隐式循环批量作图 par(mfrow = c(4, 4)) lapply(lrm_b2mix_sp, plot) Figure 21: 回归检验组图 ## $AA ## NULL ## ## $BB ## NULL ## ## $CC ## NULL ## ## $DD ## NULL # 实际值（观测值）与拟合值（预测值） par(mfrow=c(1,1)) plot(lrm_b2mix_sp$AA$fitted.values ~ lrm_b2mix_sp$AA$model$biomass) Figure 22: 拟合效果图 # Q-Q 图 qqplot() # library(car) qqPlot(lrm_b2mix_sp$AA$residuals, main = \"QQ Plot\") lapply(lrm_b2mix_sp, function(x) shapiro.test(resid(x))) # 方差齐性 with(df, by(df, species, function(d) bartlett.test(biomass ~ interaction(drought, fertilizer), d))) # library(car) # 'levene.test()' is defunct. with(df, by(df, species, function(d) leveneTest(biomass ~ drought*fertilizer, d))) fligner.test() HH::hov() # 离群点/异常值 car::outlierTest(lrm_b2mix_sp$AA) ## rstudent unadjusted p-value Bonferroni p ## 61 -5.82263 6.2157e-06 0.00018647 待办 增补/删减内容，使其更完整且专注既定主题 添加方法的利弊比较，以及用于选择的经验法则 增加多个因变量的分析，以及为不同因变量进行批量分析的 R 实现 提取主线，单独打包成自定义函数 优化作图，更符合出版格式 贡献 在本页面下方（Issues）评论/提问/回答 修改或补充内容，包括 R 语句、错别字等，可提交 pull request 参考 R语言实战 R in Action 赖江山 R 课, 广州, 2018. de Micheaux PL, et al. 潘东东, 等译. R 软件教程与统计分析：入门到精通. 2015. 北京：高等教育出版社. William M. Mendenhall, Terry L. Sincich, Nancy S. Boudreau. 2017. Statistics for engineering and the sciences. Chapman and Hall, CRC. UCLA: Data analysis examples Applied Statistics with R: Chapter 12 Analysis of Variance ANOVA in R: A step-by-step guide ","title":"R 方差分析：以多物种、双因素为例","uri":"/post/2021/07/31/r-anova/"},{"content":"所有文章（含笔记、综述、翻译、推荐等）列表：\n2021   2021/08/04 R 速查表：标准假设检验   2021/07/31 R 方差分析：以多物种、双因素为例   ","title":"归档","uri":"/archives/"},{"content":"FTZ 无中生油子站延续\n 本站如果有切实帮助到你，欢迎给予反馈（评论、提问、赞帖、纠错、补充、内容发布等等皆可）。\n一起分享、共同学习。\n","title":"欢迎","uri":"/about/"}]
